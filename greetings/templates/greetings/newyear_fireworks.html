{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>New Year Fireworks</title>
<style>
:root {
  --accent: #4ecdc4;
  --accent2: #3498db;
  --glow: rgba(255,255,255,0.6);
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  background: radial-gradient(1200px 600px at 70% -20%, rgba(255,255,255,0.08), transparent 60%),
              linear-gradient(180deg, #0b1020 0%, #0a0f1e 60%, #0a0d18 100%);
  color: #fff;
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  overflow-x: hidden;
  touch-action: none;
}

img { -webkit-user-drag: none; user-drag: none; display: block; }

.stars { position: fixed; inset: 0; z-index: 0; pointer-events: none; }
.stars::before, .stars::after {
  content: ""; position: absolute; inset: 0; background-repeat: repeat;
}
.stars::before {
  background-image:
    radial-gradient(2px 2px at 20px 30px, #fff, transparent),
    radial-gradient(1px 1px at 150px 80px, #fff, transparent),
    radial-gradient(1.5px 1.5px at 90px 200px, #fff, transparent),
    radial-gradient(1.2px 1.2px at 250px 120px, #fff, transparent);
  background-size: 200px 200px;
  animation: twinkle 8s linear infinite;
}
.stars::after {
  background-image:
    radial-gradient(1.2px 1.2px at 60px 40px, #fff, transparent),
    radial-gradient(1px 1px at 200px 160px, #fff, transparent),
    radial-gradient(1.5px 1.5px at 120px 260px, #fff, transparent),
    radial-gradient(1.2px 1.2px at 300px 200px, #fff, transparent);
  background-size: 250px 250px;
  animation: twinkle 10s linear infinite reverse;
  opacity: 0.5;
}
@keyframes twinkle { from { transform: translateY(0); } to { transform: translateY(-50px); } }

.container {
  z-index: 1;
  width: 100%;
  max-width: 1100px;
  margin: 0 auto;
  padding: 24px 16px 40px;
  flex: 1 0 auto;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
}

.title {
  text-align: center;
  font-size: clamp(1.3rem, 5vw, 2rem);
  color: #d9e8ff;
  opacity: 0.9;
}

/* Firestick */
.firestick {
  width: clamp(90px, 32vw, 150px);
  filter: drop-shadow(0 0 6px rgba(255,200,0,0.25));
  cursor: pointer;
  transition: transform 0.2s ease;
  position: relative;
  touch-action: none;
  will-change: transform;
}
.firestick:hover { transform: translateY(-2px) scale(1.02); }
.firestick.firing::after {
  content: "";
  position: absolute; bottom: -6px; left: 50%; transform: translateX(-50%);
  width: 18px; height: 24px; border-radius: 50%;
  background: radial-gradient(ellipse at center, #fff59d 0%, #ffb300 50%, rgba(255,87,34,0.9) 75%, transparent 100%);
  filter: blur(0.5px) drop-shadow(0 0 10px #ffb300);
  animation: flameFlicker 0.35s infinite alternate;
}
@keyframes flameFlicker { 0% { transform: translateX(-50%) scale(0.95); opacity: 0.9; } 100% { transform: translateX(-50%) scale(1.05); opacity: 1; } }

/* Firecrackers row */
.rack {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 12px;
  width: 100%;
  justify-items: center;
  padding-top: 4vh;
}
.cracker {
  width: clamp(100px, 40vw, 160px);
  filter: drop-shadow(0 1px 4px rgba(0,0,0,0.3));
  transition: transform 0.2s ease, filter 0.2s ease;
  user-select: none;
  will-change: transform;
}
.cracker.hover { transform: translateY(-6px) scale(1.08); filter: drop-shadow(0 0 15px rgba(255,230,0,0.6)); }

/* Ignite pulse & Launch animation */
.ignite { animation: ignitePulse 0.6s ease forwards; }
@keyframes ignitePulse { 0% { transform: translateY(0) scale(1); } 50% { transform: translateY(-6px) scale(1.06); } 100% { transform: translateY(0) scale(1.02); } }

.launch { animation: launchUp 1.8s ease-out forwards; }
@keyframes launchUp { 0% { transform: translateY(0) scale(1); opacity: 1; } 70% { transform: translateY(clamp(-60vh, -150px, -75vh)) scale(0.98); opacity: 1; } 100% { transform: translateY(clamp(-60vh, -150px, -75vh)) scale(0.96); opacity: 0; } }

/* Popup word */
.word {
  position: fixed;
  left: 50%;
  top: env(safe-area-inset-top, 15vh);
  transform: translateX(-50%);
  font-size: clamp(1.2rem, 4vw, 2rem);
  font-weight: 800;
  letter-spacing: 1px;
  color: #fff;
  text-shadow: 0 0 12px rgba(78,205,196,0.8), 0 0 22px rgba(52,152,219,0.6);
  opacity: 0;
  animation: floatWord 1.6s ease forwards;
  pointer-events: none;
  z-index: 5;
}
@keyframes floatWord { 0% { transform: translateX(-50%) translateY(10px); opacity: 0; } 20% { opacity: 1; } 80% { opacity: 1; } 100% { transform: translateX(-50%) translateY(-10px); opacity: 0; } }

/* Final message */
.final { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(0,0,0,0.6); z-index: 10; }
.final.show { display: flex; }
.final-card {
  background: linear-gradient(135deg, rgba(78,205,196,0.08), rgba(52,152,219,0.1));
  border: 1px solid rgba(78,205,196,0.5);
  backdrop-filter: blur(16px);
  padding: 28px 24px;
  width: min(92vw, 640px);
  border-radius: 20px;
  text-align: center;
  box-shadow: 0 8px 40px rgba(0,0,0,0.45);
  color: #e7f6ff;
}
.final-card h2 { font-size: clamp(1.5rem, 4vw, 2.2rem); margin: 0 0 10px; }
.final-card p { margin: 6px 0 0; color: #cfe8ff; }

/* Confetti canvas */
#confetti { position: fixed; inset: 0; z-index: 2; pointer-events: none; }

/* Drag ghost */
.drag-ghost { position: fixed; pointer-events: none; z-index: 9999; opacity: 0.9; }

/* Footer */
/* Sticky Footer Layout */
body {
  display: flex;
  flex-direction: column;
  min-height: 100vh; /* Ensure footer sticks to bottom if content is short */
}

.container {
  flex: 1 0 auto; /* Makes container take available space, pushing footer down */
}

.site-footer {
  flex-shrink: 0; /* Prevent footer from shrinking */
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  background: rgba(0,0,0,0.5);
  border-top: 1px solid rgba(78,205,196,0.3);
  backdrop-filter: blur(8px);
  color: #d9e8ff;
  font-size: clamp(0.85rem, 3vw, 1rem);
  width: 100%;
}

.site-footer .footer-left {
  display: flex;
  align-items: center;
  gap: 6px;
}

.site-footer .badge {
  background: var(--accent2);
  color: #fff;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 0.8em;
  font-weight: 600;
}

.site-footer .footer-right {
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}

.site-footer a {
  text-decoration: none;
  color: #4ecdc4;
  display: flex;
  align-items: center;
  gap: 4px;
  transition: color 0.2s ease;
}

.site-footer a:hover {
  color: #fff;
}

@media (max-width: 480px) {
  .site-footer {
    flex-direction: column;
    gap: 6px;
    text-align: center;
  }
  .site-footer .footer-right {
    justify-content: center;
  }
}

</style>
</head>
<body>

<canvas id="confetti"></canvas>
<div class="stars"></div>

<div class="container">
  <div class="title">{{ config.title }}</div>
  <div class="title">Drag the firestick to each firecracker to launch ðŸŽ‡</div>
  <div class="top">
    <img src="{% static 'images/firestick.png' %}" alt="Firestick" class="firestick" id="firestick" />
  </div>

  <div class="rack" id="rack">
    <img src="{% static 'images/firecracker1.png' %}" alt="Firecracker 1" class="cracker" />
    <img src="{% static 'images/firecracker2.png' %}" alt="Firecracker 2" class="cracker" />
    <img src="{% static 'images/firecracker3.png' %}" alt="Firecracker 3" class="cracker" />
    <img src="{% static 'images/firecracker4.png' %}" alt="Firecracker 4" class="cracker" />
    <img src="{% static 'images/firecracker5.png' %}" alt="Firecracker 5" class="cracker" />
  </div>
</div>

<div class="final" id="final">
  <div class="final-card">
    <div style="font-size: 2rem; margin-bottom: 10px;">ðŸŽ‰ Happy New Year 2025 ðŸŽ‰</div>
    <h2>Wishing you joy, health, and success ahead!</h2>
    <p>May your year sparkle with new possibilities and bright moments.</p>
  </div>
</div>
<!-- Footer -->
<footer class="site-footer" role="contentinfo" aria-label="Footer">
    <div class="footer-left">
        <span class="badge">Greetings</span>
        <strong>from Pratham Rathod & Family</strong>
    </div>
    <div class="footer-right">
        <a href="https://www.linkedin.com/in/pratham-rathod-319b61370/" target="_blank" rel="noopener" aria-label="LinkedIn">
            ðŸ”— <span>LinkedIn</span>
        </a>
        <a href="https://www.instagram.com/_i_m_pratham03_/" target="_blank" rel="noopener" aria-label="Instagram">
            ðŸ“· <span>Instagram</span>
        </a>
        <a href="https://mean-portfolio-site.vercel.app/" target="_blank" rel="noopener" aria-label="Portfolio">
            ðŸ’¼ <span>Portfolio</span>
        </a>
    </div>
</footer>


<script>
const firestick = document.getElementById('firestick');
const crackers = Array.from(document.querySelectorAll('.cracker'));
const messages = ["Joy", "Love", "Success", "Happiness", "Prosperity"];
const final = document.getElementById('final');
let nextIndex = 0, isDragging = false, ghost = null, currentHover = null;

// Drag start
firestick.addEventListener('pointerdown', (e) => {
  if (isDragging) return;
  isDragging = true;
  firestick.style.opacity = '0.35';
  firestick.classList.add('firing');
  createGhost();
  updateGhost(e.clientX, e.clientY);
  playIgniteSound();
  window.setPointerCapture?.(e.pointerId);
});

// Drag move
window.addEventListener('pointermove', (e) => {
  if (!isDragging) return;
  updateGhost(e.clientX, e.clientY);
  checkOverlap(e.clientX, e.clientY);
});

// Drag end
window.addEventListener('pointerup', endDrag);
window.addEventListener('pointercancel', endDrag);

function endDrag() {
  if (!isDragging) return;
  isDragging = false;
  firestick.style.opacity = '1';
  firestick.classList.remove('firing');
  if (ghost) { ghost.remove(); ghost = null; }
  if (currentHover) { currentHover.classList.remove('hover'); currentHover = null; }
}

// Ghost for drag
function createGhost() {
  ghost = firestick.cloneNode(true);
  ghost.classList.add('drag-ghost');
  ghost.style.width = firestick.offsetWidth + 'px';
  ghost.style.height = firestick.offsetHeight + 'px';
  document.body.appendChild(ghost);
}
function updateGhost(x, y) {
  if (!ghost) return;
  const w = ghost.offsetWidth, h = ghost.offsetHeight;
  ghost.style.left = (x - w/2) + 'px';
  ghost.style.top = (y - h/2) + 'px';
}

// Check overlap with crackers
function checkOverlap(x, y) {
  const el = document.elementFromPoint(x, y);
  const cracker = el ? el.closest('.cracker') : null;
  if (currentHover && currentHover !== cracker) currentHover.classList.remove('hover');
  if (cracker && crackers.indexOf(cracker) === nextIndex && !cracker.classList.contains('launch')) {
    cracker.classList.add('hover'); currentHover = cracker; igniteAndLaunch(nextIndex);
  } else currentHover = null;
}

// Ignite + Launch
function igniteAndLaunch(i) {
  const el = crackers[i];
  if (el.dataset.launched === '1') return;
  el.dataset.launched = '1';
  el.classList.add('ignite');
  playIgniteSound();
  setTimeout(() => {
    el.classList.add('launch');
    showWord(messages[i % messages.length]);
    playLaunchSound();
    el.addEventListener('animationend', function onEnd() {
      el.removeEventListener('animationend', onEnd);
      nextIndex++;
      if (currentHover === el) { el.classList.remove('hover'); currentHover = null; }
      if (nextIndex >= crackers.length) setTimeout(() => { showConfetti(4500); final.classList.add('show'); }, 500);
    });
  }, 350);
}

// Show floating word
function showWord(text) {
  const w = document.createElement('div');
  w.className = 'word';
  w.textContent = text;
  document.body.appendChild(w);
  w.addEventListener('animationend', () => w.remove());
}

// Confetti
function showConfetti(duration = 3000) {
  const canvas = document.getElementById('confetti');
  const ctx = canvas.getContext('2d');
  let W = canvas.width = window.innerWidth * devicePixelRatio;
  let H = canvas.height = window.innerHeight * devicePixelRatio;
  ctx.scale(devicePixelRatio, devicePixelRatio);

  const colors = ['#ff5f6d','#ffc371','#4ecdc4','#45b7d1','#ffd166','#f4a261'];
  const pieces = Array.from({length:120}, () => ({
    x: Math.random()*W, y:-20-Math.random()*H, w:6+Math.random()*6, h:8+Math.random()*10,
    c: colors[Math.floor(Math.random()*colors.length)],
    vx: -1+Math.random()*2, vy:2+Math.random()*3,
    rot: Math.random()*Math.PI, vr:-0.1+Math.random()*0.2
  }));

  let start = performance.now();
  let raf;
  function draw(ts) {
    const t = ts-start;
    ctx.clearRect(0,0,W,H);
    for (const p of pieces) {
      p.x += p.vx; p.y += p.vy; p.rot += p.vr;
      if (p.y>H+20){ p.y=-20; p.x=Math.random()*W; }
      ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.rot);
      ctx.fillStyle=p.c; ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h);
      ctx.restore();
    }
    raf = requestAnimationFrame(draw);
    if (t>duration){ cancelAnimationFrame(raf); ctx.clearRect(0,0,W,H); }
  }
  window.addEventListener('resize', () => { W = canvas.width = window.innerWidth*devicePixelRatio; H = canvas.height = window.innerHeight*devicePixelRatio; ctx.scale(devicePixelRatio,devicePixelRatio); });
  raf = requestAnimationFrame(draw);
  setTimeout(()=>{ cancelAnimationFrame(raf); ctx.clearRect(0,0,W,H); }, duration+200);
}

// Sounds
function playIgniteSound() {
  try{ const ctx = new (window.AudioContext||window.webkitAudioContext)(); const osc=ctx.createOscillator(); const gain=ctx.createGain(); osc.type='triangle'; osc.frequency.value=700; gain.gain.setValueAtTime(0.18,ctx.currentTime); gain.gain.exponentialRampToValueAtTime(0.01,ctx.currentTime+0.25); osc.connect(gain); gain.connect(ctx.destination); osc.start(); osc.stop(ctx.currentTime+0.25); } catch{}
}
function playLaunchSound() {
  try{ const ctx = new (window.AudioContext||window.webkitAudioContext)(); const osc=ctx.createOscillator(); const gain=ctx.createGain(); osc.type='sawtooth'; osc.frequency.setValueAtTime(300,ctx.currentTime); osc.frequency.exponentialRampToValueAtTime(1200,ctx.currentTime+0.35); gain.gain.setValueAtTime(0.15,ctx.currentTime); gain.gain.exponentialRampToValueAtTime(0.01,ctx.currentTime+0.35); osc.connect(gain); gain.connect(ctx.destination); osc.start(); osc.stop(ctx.currentTime+0.35); } catch{}
}
</script>
</body>
</html>
